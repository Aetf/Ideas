# 方块世界构思 #

## 基本思路 ##
类似Minecraft，提供一个3维的可无限扩展的自由世界。
玩家控制游戏角色与这一世界进行交互，包括摧毁、放置方块，与实体交互等。

实际是在内存中对玩家可视范围内的方块状态定期更新。
现阶段没有引入类红石电路的情况下，可以采用被动更新的方式，即
除初始化外，只有当玩家做出操作后，才对操作可能影响到的方块状态进行更新。

每个方块本身相当于一个逻辑函数，输入是它附近的某些方块的状态，输出是自身状态，
或对相邻方块状态的改变。

## 游戏世界 ##

#### 游戏世界中能够存在什么 ####
一切可能出现在游戏屏幕中的东西

+ 方块
 - __泥土__: 最基础，存在多种状态，不受重力影响
   * __草地__: 顶部长草的贴图
   * __普通__: 泥土地
 - __沙子__: 受到重力影响
 - __流体__: 在一定范围内扩散，受重力影响
   * __水源__: 水的源头，一定会扩散
   * __扩散的水__: 水源扩散出来的水，随扩散次数增加丧失扩散能力，本身利用状态记录扩散能力
   * __仅向下扩散的水__: 水源扩散出来的水，只能向下扩散，遇到障碍才能向四周扩散，本身利用状态记录扩散能力
 - __半方块__: 存在位置有某些限制的方块
   * __草__: 注意与草地泥土方块不同，只能存在于泥土方块的上方
+ 实体: 受到重力影响
 - 所有非方块、非生物的东西
   * 掉落的物品
   * 移动中的方块，如移动中的沙子
 - 生物
   * 玩家
   * 敌对生物
   * 非敌对生物

---

玩家可以携带的物品

+ 方块
    * 普通泥土块
    * 沙子块
+ 一般物品
    * 草种子
    * 空水桶
    * 满水桶
    * 燧石

#### 允许的玩家与世界的交互 ####
玩家可以怎么改变这个世界

+ 摧毁方块
    * 可能掉出相应方块或其它物品
+ 放置/使用物品
    * 可以是方块
    * 可以是某些物品
+ 捡起某些实体
+ 与其它生物交互
    * 攻击
    * 受到攻击
    * 其它交互
+ 碰撞的计算
    * 只有方块和生物计算碰撞

---

放置/使用物品时玩家手持相应物品，瞄准某一位置。

必要参数为 a)放置/使用的物品 b)瞄准的坐标

+ 方块: 产生方块
+ 草种子: 在泥土上时，h%几率产生草
+ 满水桶: 产生水源，变成空水桶
+ 空水桶: 在水源上时，变成满水桶，水源消失

---

摧毁方块时玩家手持某种工具(可空手)，瞄准某一位置。

必要参数为 a)使用的工具 b)瞄准的坐标

+ 方块
    * 泥土
        - 草地泥土、普通泥土摧毁后掉出普通泥土块
    * 沙子
        - 摧毁后有d%概率掉出燧石，1-d%概率掉出沙子
    * 草
        - 被摧毁有g%概率掉出草种子

#### 怎么对方块状态进行更新 ####
具体的每种方块的更新规则

+ 泥土
    * 普通泥土经过a个单位时间后有b%的概率变成__草地__
    * 没有连通足够体积的方块群的草地在c个单位时间后变成__普通泥土__
+ 沙子
    * 当正下方没有方块时，向下掉落
+ 水源
    * 每e个单位时间检查四周及下方是否存在方块，如果没有，填入扩散性为i的__扩散的水__
+ 扩散的水
    * __扩散性不为0__的情况下，每e个单位时间检查四周是否存在方块，如果没有，填入__扩散性减一__的__扩散的水__
    * 每e个单位时间检查下方是否存在方块，如果没有，填入__相同扩散性__的__仅向下扩散的水__
    * 每e个单位时间检查是否与至少一个__扩散性不低于本身__的__扩散的水__或__水源__相邻，如果没有，本身消失
+ 仅向下扩散的水
    * 每e个单位时间检查下方是否存在方块，如果有，将本身转换为__同等扩散性__的__扩散的水__，并立即执行扩散的水的更新检测。如果没有，填入__相同扩散性__的__仅向下扩散的水__
    * 每e个单位时间检查上方是否是__与本身相同扩散性__的__扩散的水__或__仅向下扩散的水__，本身转换为__同等扩散性__的__扩散的水__，并立即执行相应更新检测
+ 草
    * 每f个单位时间检查下方方块是否存在且为__泥土__，如果不是，本身消失
